# üöÄ –ë—ã—Å—Ç—Ä–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

## –ß—Ç–æ –±—ã–ª–æ —Å–æ–∑–¥–∞–Ω–æ

‚úÖ Docker –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (`docker-compose.yml`, `Dockerfile`)
‚úÖ –°–∫—Ä–∏–ø—Ç—ã –±—ç–∫–∞–ø–∞ (`scripts/backup-*.sh`)
‚úÖ –°–∫—Ä–∏–ø—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è (`scripts/restore.sh`)
‚úÖ –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –±—ç–∫–∞–ø–æ–≤ (`html/backup-download.php`)
‚úÖ `.gitignore` (–∏—Å–∫–ª—é—á–∞–µ—Ç –ø–ª–∞–≥–∏–Ω—ã –∏ —Å–µ–∫—Ä–µ—Ç—ã)
‚úÖ README —Å –ø–æ–ª–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π

## ‚ö†Ô∏è –í–ê–ñ–ù–û: –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –°–ï–ô–ß–ê–°

### 1. –ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –±—ç–∫–∞–ø–æ–≤

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `/var/www/html/backup-download.php` –∏ –∏–∑–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä–æ–∫—É 10:

```php
$BACKUP_PASSWORD = '–≤–∞—à_–±–µ–∑–æ–ø–∞—Å–Ω—ã–π_–ø–∞—Ä–æ–ª—å_–∑–¥–µ—Å—å';
```

### 2. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π –±—ç–∫–∞–ø

```bash
cd /var/www
./scripts/backup-all.sh
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç:
- `backups/db-latest.sql.gz` - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- `backups/plugins-latest.tar.gz` - –≤—Å–µ –ø–ª–∞–≥–∏–Ω—ã
- `backups/uploads-latest.tar.gz` - –º–µ–¥–∏–∞ —Ñ–∞–π–ª—ã
- `backups/wp-config-latest.enc` - –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π wp-config.php
- `backups/flatsome-child-latest.tar.gz` - –≤–∞—à–∞ —Ç–µ–º–∞

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
https://ru-pills.com/backup-download.php
```

–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª—ã –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è.

### 4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã

–î–æ–±–∞–≤—å—Ç–µ –≤ crontab:
```bash
crontab -e
```

–î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É (–±—ç–∫–∞–ø –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤):
```
0 */6 * * * /var/www/scripts/backup-all.sh >> /var/www/backups/backup.log 2>&1
```

### 5. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
cd /var/www
git init
git add .
git commit -m "Initial commit: Docker infrastructure for ru-pills.com"

# –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub, –∑–∞—Ç–µ–º:
git remote add origin https://github.com/–≤–∞—à-username/rupills-infra.git
git branch -M main
git push -u origin main
```

## üì• –ö–∞–∫ —Å–∫–∞—á–∞—Ç—å –±—ç–∫–∞–ø—ã

1. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ `https://ru-pills.com/backup-download.php`
2. –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å
3. –°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª—ã —Å —Å—É—Ñ—Ñ–∏–∫—Å–æ–º `-latest`:
   - `db-latest.sql.gz` - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
   - `plugins-latest.tar.gz` - –ø–ª–∞–≥–∏–Ω—ã
   - `uploads-latest.tar.gz` - –º–µ–¥–∏–∞
   - `wp-config-latest.enc` - –∫–æ–Ω—Ñ–∏–≥ (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω)
   - `flatsome-child-latest.tar.gz` - —Ç–µ–º–∞

## üîÑ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ –Ω–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å GitHub
2. –°–∫–∞—á–∞–π—Ç–µ –±—ç–∫–∞–ø—ã —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
3. –ü–æ–º–µ—Å—Ç–∏—Ç–µ –∏—Ö –≤ `backups/`
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `./scripts/restore.sh all`

–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ `README.md`

## üìù –ß—Ç–æ –ù–ï –ø–æ–ø–∞–¥–∞–µ—Ç –≤ Git

- –ü–ª–∞–≥–∏–Ω—ã (–∫—Ä—è–∫–Ω—É—Ç—ã–µ) - —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –±—ç–∫–∞–ø—ã
- WordPress core - —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö - —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –±—ç–∫–∞–ø—ã
- wp-config.php - —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –±—ç–∫–∞–ø—ã
- Uploads - —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –±—ç–∫–∞–ø—ã

–í—Å—ë —ç—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –±—ç–∫–∞–ø–∞—Ö –∏ –¥–æ—Å—Ç—É–ø–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å!
